<!doctype html><html><head><meta charset="UTF-8"><title>Darkside</title><style type="text/css">*{margin:0;padding:0}body,canvas,html{width:100%;height:100%}canvas{display:block}</style></head><body><script type="text/javascript">!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t){t.exports={VACUUM:[0,0,0,0,0,0],SCHOTT_BK7:[1.03961212,.231792344,.231792344,.00600069867,.0200179144,103.560653],SCHOTT_BAF10:[1.5851495,.143559385,1.08521269,.00926681282,.0424489805,105.613573],SCHOTT_SF10:[1.61625977,.259229334,1.07762317,.0127534559,.0581983954,116.60768]}},function(t,e,i){},function(t,e,i){"use strict";i.r(e);class n{constructor(t=0,e=0){this.x=t,this.y=e}toRadians(){return Math.atan2(this.y,this.x)}static fromRadians(t){return new n(Math.cos(t),Math.sin(t))}static average(t,e){return new n((t.x+e.x)/2,(t.y+e.y)/2)}scale(t){return new n(this.x*t,this.y*t)}plus(t){return new n(this.x+t.x,this.y+t.y)}minus(t){return new n(this.x-t.x,this.y-t.y)}magnitude(){return Math.hypot(this.x,this.y)}normalize(){return this.scale(1/this.magnitude())}rotate(t){return new n(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t))}}function r(t,e,i){e.beginPath(),e.fillStyle=i.toString();let n=t[t.length-1];e.moveTo(n.x,n.y);for(let i of t)e.lineTo(i.x,i.y);e.fill()}class s{constructor(t=0,e=0,i=0){this.r=Math.min(Math.max(t,0),255),this.g=Math.min(Math.max(e,0),255),this.b=Math.min(Math.max(i,0),255)}toString(){return"#"+this.r.toString(16).padStart(2,"0")+this.g.toString(16).padStart(2,"0")+this.b.toString(16).padStart(2,"0")}}class o{constructor(t=new n(0,0),e=0,i=[]){this.offset=0,this.count=0,this.position=t,this.spectrum=i,this.rotation=e}draw(t,e,i){if(this.spectrum.length<1)return;this.offset=this.offset+i/350,this.count++;const r=this.spectrum.map(t=>t.toRGB()).reduce((t,e)=>new s(Math.floor((t.r+e.r)/1),Math.floor((t.g+e.g)/1),Math.floor((t.b+e.b)/1))),o=n.fromRadians(this.rotation).scale(300).plus(this.position);!function(t,e,i,r){const s=t.end.minus(t.start),o=s.toRadians(),a=s.magnitude();for(let s=t.count/2%20;s<a;s+=20){e.beginPath();const a=t.amplitude*Math.sin(s/t.period+t.offset),{x:h,y:c}=new n(s,a).rotate(o).plus(t.start),l=4;let u=e.createRadialGradient(h,c,1,h,c,l);u.addColorStop(0,i.toString()),u.addColorStop(1,r.backgroundColor.toString()),e.lineWidth=1,0===s&&e.moveTo(h,c+.5),e.fillStyle=u,e.fillRect(h-l-2,c-l-2,h+l+2,c+l+2)}}({start:this.position,end:o,amplitude:6,period:12,offset:-this.offset,count:this.count},t,r,e)}}class a{constructor(t=new s(0,0,0),e=new s(255,255,255),i=10,n="#FFFFFF",r=20){this.backgroundColor=t,this.lineColor=e,this.lineWidth=i,this.lightsourceColor=n,this.lightsourceRadius=r}}class h{constructor(t=[],e=[],i=new a){this.lights=t,this.prisms=e,this.config=i}render(t,e){t.fillStyle=this.config.backgroundColor.toString(),t.fillRect(0,0,t.canvas.width,t.canvas.height),this.lights.concat(this.prisms).map(i=>{t.save(),i.draw(t,this.config,e),t.restore()})}}var c,l=i(0);!function(t){t.VACUUM="VACUUM",t.SCHOTT_BK7="SCHOTT_BK7",t.SCHOTT_BAF10="SCHOTT_BAF10",t.SCHOOTT_SF10="SCHOTT_SF10"}(c||(c={}));const u=new class{constructor(t=c.SCHOTT_BK7){this.name=t;const e=l[t];this.b1=e[0],this.b2=e[1],this.b3=e[2],this.c1=e[3],this.c2=e[4],this.c3=e[5]}refractiveIndex(t){t/=1e3;const e=this.b1*t**2/(t**2-this.c1),i=this.b2*t**2/(t**2-this.c2),n=this.b3*t**2/(t**2-this.c3);return Math.sqrt(1+e+i+n)}};class d{constructor(t,e=u){this.vertices=t,this.inner=d.calculateInnerVertices(t),this.material=e}static calculateInnerVertices(t){let e=[];const i=t.reduce((t,e)=>t.plus(e)).scale(1/t.length);for(let n of t){const t=n.minus(i);e.push(t.normalize().scale(t.magnitude()-5).plus(i))}return e}setVertices(t){this.vertices=t,this.inner=d.calculateInnerVertices(t)}draw(t,e,i){t.shadowBlur=4,t.shadowColor=e.lineColor.toString(),r(this.vertices,t,e.lineColor),t.shadowBlur=5,t.shadowColor=e.backgroundColor.toString(),r(this.inner,t,e.backgroundColor)}}class f{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}toRGB(){let t=3.2404542*this.x-1.5371385*this.y-.4985314*this.z,e=-.969266*this.x+1.8760108*this.y+.041556*this.z,i=.0556434*this.x-.2040259*this.y+1.0572252*this.z;return t=Math.floor(255*this.gammaCorrection(t)),e=Math.floor(255*this.gammaCorrection(e)),i=Math.floor(255*this.gammaCorrection(i)),new s(t,e,i)}gammaCorrection(t){return t=Math.max(t,0),Math.abs(t)<.0031308?12.92*t:1.055*t**(1/2.4)-.055}}class p{constructor(t){this.value=t}refract(t,e,i){if(t.name===e.name)return i;const n=t.refractiveIndex(this.value),r=e.refractiveIndex(this.value);return Math.sin(i)*(n/r)}toRGB(){return this.toXYZ().toRGB()}toXYZ(){return new f(this.x(),this.y(),this.z())}x(){let t=(this.value-442)*(this.value<442?.0624:.0374),e=(this.value-599.8)*(this.value<599.8?.0264:.0323),i=(this.value-501.1)*(this.value<501.1?.049:.0382);return.362*Math.exp(-.5*t*t)+1.056*Math.exp(-.5*e*e)-.065*Math.exp(-.5*i*i)}y(){let t=(this.value-568.8)*(this.value<568.8?.0213:.0247),e=(this.value-530.9)*(this.value<530.9?.0613:.0322);return.821*Math.exp(-.5*t*t)+.286*Math.exp(-.5*e*e)}z(){let t=(this.value-437)*(this.value<437?.0845:.0278),e=(this.value-459)*(this.value<459?.0385:.0725);return 1.217*Math.exp(-.5*t*t)+.681*Math.exp(-.5*e*e)}}i(1);function m(t,e){const i=e.canvas;i.width=window.innerWidth,i.height=window.innerHeight;const r=new o(new n(.5*i.width-5,.5*i.height-5),0,[new p(475),new p(550),new p(600),new p(750)]),s=new n(.7*i.width,.5*i.height),a=new d(function(t,e,i=0){let r=t.x,s=t.y;return[new n(r-e*Math.sin(i),s-e*Math.cos(i)),new n(r-e*Math.sin(i+2*Math.PI/3),s-e*Math.cos(i+2*Math.PI/3)),new n(r-e*Math.sin(i+4*Math.PI/3),s-e*Math.cos(i+4*Math.PI/3))]}(s,100));t.lights=[r],t.prisms=[a]}document.addEventListener("DOMContentLoaded",()=>{console.log("Darkside started");let t=document.createElement("canvas");document.body.appendChild(t);let e=t.getContext("2d"),i=new h;window.addEventListener("resize",()=>m(i,e)),m(i,e);i.render(e,1/60);var n=performance.now();setInterval(()=>{let t=performance.now(),r=t-n;i.render(e,r),n=performance.now(),console.log("Update+render took: "+(n-t)+"ms")},1e3/60)})}]);
//# sourceMappingURL=bundle.js.map</script></body></html>