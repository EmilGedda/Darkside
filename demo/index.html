<!doctype html><html><head><meta charset="UTF-8"><title>Darkside</title><style type="text/css">*{margin:0;padding:0}body,canvas,html{width:100%;height:100%}canvas{display:block}</style></head><body><script type="text/javascript">!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t){t.exports={VACUUM:[0,0,0,0,0,0],SCHOTT_BK7:[1.03961212,.231792344,.231792344,.00600069867,.0200179144,103.560653],SCHOTT_BAF10:[1.5851495,.143559385,1.08521269,.00926681282,.0424489805,105.613573]}},function(t,e,i){},function(t,e,i){"use strict";i.r(e);class n{constructor(t=0,e=0){this.x=t,this.y=e}toRadians(){return Math.atan2(this.y,this.x)}static fromRadians(t){return new n(Math.cos(t),Math.sin(t))}scale(t){return new n(this.x*t,this.y*t)}plus(t){return new n(this.x+t.x,this.y+t.y)}}function s(t,e,i=0){let s=t.x,r=t.y;return[new n(s-e*Math.sin(i),r-e*Math.cos(i)),new n(s-e*Math.sin(i+2*Math.PI/3),r-e*Math.cos(i+2*Math.PI/3)),new n(s-e*Math.sin(i+4*Math.PI/3),r-e*Math.cos(i+4*Math.PI/3))]}function r(t,e,i){let n=t[t.length-1];for(let s of t)e.beginPath(),e.strokeStyle=i.toString(),e.moveTo(n.x,n.y),e.lineTo(s.x,s.y),e.stroke(),e.closePath(),n=s}class o{constructor(t=0,e=0,i=0){this.r=Math.min(Math.max(t,0),255),this.g=Math.min(Math.max(e,0),255),this.b=Math.min(Math.max(i,0),255)}toString(){return"#"+this.r.toString(16).padStart(2,"0")+this.g.toString(16).padStart(2,"0")+this.b.toString(16).padStart(2,"0")}}class a{constructor(t=new n(0,0),e=0,i=[]){this.position=t,this.spectrum=i,this.rotation=e}draw(t,e){if(this.spectrum.length<1)return;const i=this.spectrum.map(t=>t.toRGB()).reduce((t,e)=>new o(Math.floor((t.r+e.r)/2),Math.floor((t.g+e.g)/2),Math.floor((t.b+e.b)/2))),s=n.fromRadians(this.rotation).scale(300).plus(this.position);r([this.position,s],t,i)}}class h{constructor(t="#000000",e=new o(255,255,255),i=10,n="#FFFFFF",s=20){this.backgroundColor=t,this.lineColor=e,this.lineWidth=i,this.lightsourceColor=n,this.lightsourceRadius=s}}class c{constructor(t=[],e=[],i=new h){this.lights=t,this.prisms=e,this.config=i}render(t){t.fillStyle=this.config.backgroundColor,t.fillRect(0,0,t.canvas.width,t.canvas.height),this.lights.concat(this.prisms).map(e=>e.draw(t,this.config))}update(t){console.log("Sleep time: "+t+"ms")}}var l,u=i(0);!function(t){t.VACUUM="VACUUM",t.SCHOTT_BK7="SCHOTT_BK7",t.SCHOTT_BAF10="SCHOTT_BAF10"}(l||(l={}));const d=new class{constructor(t=l.SCHOTT_BK7){this.name=t;const e=u[t];this.b1=e[0],this.b2=e[1],this.b3=e[2],this.c1=e[3],this.c2=e[4],this.c3=e[5]}refractiveIndex(t){t/=1e3;const e=this.b1*t**2/(t**2-this.c1),i=this.b2*t**2/(t**2-this.c2),n=this.b3*t**2/(t**2-this.c3);return Math.sqrt(1+e+i+n)}};class f{constructor(t,e=d){this.vertices=t,this.material=e}draw(t,e){r(this.vertices,t,e.lineColor)}}class m{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}toRGB(){let t=3.2404542*this.x-1.5371385*this.y-.4985314*this.z,e=-.969266*this.x+1.8760108*this.y+.041556*this.z,i=.0556434*this.x-.2040259*this.y+1.0572252*this.z;return t=Math.floor(255*this.gammaCorrection(t)),e=Math.floor(255*this.gammaCorrection(e)),i=Math.floor(255*this.gammaCorrection(i)),new o(t,e,i)}gammaCorrection(t){return t=Math.max(t,0),Math.abs(t)<.0031308?12.92*t:1.055*t**(1/2.4)-.055}}class p{constructor(t){this.value=t}refract(t,e,i){if(t.name===e.name)return i;const n=t.refractiveIndex(this.value),s=e.refractiveIndex(this.value);return Math.sin(i)*(n/s)}toRGB(){return this.toXYZ().toRGB()}toXYZ(){return new m(this.x(),this.y(),this.z())}x(){let t=(this.value-442)*(this.value<442?.0624:.0374),e=(this.value-599.8)*(this.value<599.8?.0264:.0323),i=(this.value-501.1)*(this.value<501.1?.049:.0382);return.362*Math.exp(-.5*t*t)+1.056*Math.exp(-.5*e*e)-.065*Math.exp(-.5*i*i)}y(){let t=(this.value-568.8)*(this.value<568.8?.0213:.0247),e=(this.value-530.9)*(this.value<530.9?.0613:.0322);return.821*Math.exp(-.5*t*t)+.286*Math.exp(-.5*e*e)}z(){let t=(this.value-437)*(this.value<437?.0845:.0278),e=(this.value-459)*(this.value<459?.0385:.0725);return 1.217*Math.exp(-.5*t*t)+.681*Math.exp(-.5*e*e)}}i(1);function g(t,e){const i=e.canvas;i.width=window.innerWidth,i.height=window.innerHeight;const r=new n(.7*i.width,.5*i.height);let o=[new n(.2*i.width-5,.2*i.height-5),new n(.5*i.width-5,.5*i.height-5),new n(.8*i.width-5,.8*i.height-5),r].map(t=>new a(t));o[1].spectrum=[new p(700),new p(400)];let h=[s(r,100)].map(t=>new f(t));t.lights=o,t.prisms=h}document.addEventListener("DOMContentLoaded",()=>{console.log("Darkside started");let t=document.createElement("canvas");document.body.appendChild(t);let e=t.getContext("2d"),i=new c;window.addEventListener("resize",()=>{g(i,e)}),g(i,e),i.render(e);var n=(new Date).getTime();setInterval(()=>{var t=(new Date).getTime(),s=t-n;i.update(s),i.render(e),n=(new Date).getTime(),console.log("Update+render took: "+(n-t)+"ms")},1e3)})}]);
//# sourceMappingURL=bundle.js.map</script></body></html>